<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chaud Devant - Showcase</title>
    <style>
        :root {
            /* Fond sombre bleu-vert presque noir */
            --bg-base: #020b0e;
            --text-color: #e0f2f1;
            --card-bg: #091418;
        }

        body, html {
            margin: 0;
            padding: 0;
            background-color: var(--bg-base);
            color: var(--text-color);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Conteneur principal - Mosaïque */
        #feed {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
            padding: 40px;
            box-sizing: border-box;
            width: 100%;
            max-width: 1800px;
            margin: 0 auto;
        }

        /* Carte vidéo */
        .video-card {
            background: var(--card-bg);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        .video-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 12px rgba(0,0,0,0.4);
        }

        .video-container {
            position: relative;
            width: 100%;
            /* Aspect ratio par défaut ou auto, on laisse la video déterminer la hauteur ou on fixe un ratio commun? 
               Pour "formats originaux sans bande noires", on laisse la video prendre sa place. 
               Mais pour une grille alignée, c'est mieux d'avoir une consistance. 
               Essayons width 100% et height auto. */
            background: #000;
            line-height: 0;
        }

        video {
            width: 100%;
            height: auto;
            display: block;
            object-fit: cover; /* Remplit la largeur */
        }

        /* Overlay Play */
        .play-overlay {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            color: rgba(255,255,255,0.7);
            font-size: 3rem;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }
        
        /* Quand la vidéo est en pause ou au chargement initial */
        .video-container.paused .play-overlay {
            opacity: 1;
        }

        /* Infos méta */
        .meta-info {
            padding: 15px;
            font-size: 0.9rem;
            text-align: left;
            border-top: 1px solid rgba(255,255,255,0.05);
        }

        .meta-title {
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #b0bec5;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
    </style>
</head>
<body>

<div id="feed">
    <!-- Vidéos ici -->
</div>

<script>
    const feed = document.getElementById('feed');
    let videosData = [];

    function createSlide(videoInfo) {
        const card = document.createElement('div');
        card.className = 'video-card';
        
        // Priorité modifiée pour trouver le format le plus "original" / grand possible
        // Si "16x9" existe, c'est souvent le format ciné. Sinon 1x1.
        let videoUrl = videoInfo.bunny_urls['16x9'];
        if (!videoUrl) videoUrl = videoInfo.bunny_urls['1x1'];
        if (!videoUrl) videoUrl = videoInfo.bunny_urls['9x16'];

        if (!videoUrl) return null;

        card.innerHTML = `
            <div class="video-container paused">
                <video loop playsinline muted preload="metadata">
                    <source src="${videoUrl}" type="video/mp4">
                </video>
                <div class="play-overlay">
                    <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor"><path d="M8 5v14l11-7z"/></svg>
                </div>
            </div>
            <div class="meta-info">
                <div class="meta-title">${videoInfo.id.replace(/_/g, ' ')}</div>
            </div>
        `;

        const container = card.querySelector('.video-container');
        const video = card.querySelector('video');
        
        // Click to play/pause
        container.addEventListener('click', () => {
             if (video.paused) {
                 // Stop d'autres vidéos si nécessaire? Pas obligatoire pour une mosaïque
                 // video.muted = false; // Optionnel : activer le son au clic
                 video.play();
                 container.classList.remove('paused');
             } else {
                 video.pause();
                 container.classList.add('paused');
             }
        });
        
        // Mouse enter/leave pour autoplay silencieux (preview)
        card.addEventListener('mouseenter', () => {
            if(video.paused) {
                video.muted = true;
                video.play().catch(()=>{});
                container.classList.remove('paused');
            }
        });

        card.addEventListener('mouseleave', () => {
             if(!video.paused) {
                 video.pause();
                 video.currentTime = 0;
                 container.classList.add('paused');
             }
        });

        return card;
    }

    async function init() {
        try {
            const response = await fetch('showcase.json');
            videosData = await response.json();
            
            // Inverser pour avoir les récents en premier ?? Oui selon le code précédent
            videosData.reverse().forEach(vid => {
                const el = createSlide(vid);
                if (el) feed.appendChild(el);
            });

            // On retire l'IntersectionObserver style "snap scroll"
            // La mosaïque gère l'affichage statique

        } catch (e) {
            console.error(e);
            feed.innerHTML = "<h2 style='text-align:center; margin-top:100px; color:#555;'>Chargement...</h2>";
        }
    }

    // Plus besoin de setupObserver pour l'activation au scroll snap.
    // Les vidéos se jouent au survol.

    init();
</script>


</body>
</html>
